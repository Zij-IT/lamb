STRUCT: TokenStruct TokenIdent TokenLBrace STRUCT_MEMS TokenRBrace

STRUCT_MEMS: STRUCT_MEM TokenComma STRUCT_MEMS
		   | STRUCT_MEM
		   | 

STRUCT_MEM: TokenIdent TokenColon TokenIdent
		
ENUM: TokenEnum TokenIdent TokenLBrace ENUM_VARS TokenRBrace 

ENUM_VARS: ENUM_VAR TokenComma ENUM_VARS
		 | ENUM_VAR
		 | 

ENUM_VAR: TokenIdent ENUM_VAR
		| TokenIdent

BLOCK: TokenLBrace STMTS TokenRBrace

STMT : TokenIdent TokenDefine EXPR TokenSemicolon
	 | EXPR TokenSemicolon

EXPR: EXPR TokenAdd EXPR
	| EXPR TokenSub EXPR
	| EXPR TokenMul EXPR
	| EXPR TokenDiv EXPR
	| FUNC_CALL
	| IF_EXPR
	| CASE_EXPR
	| ATOM

ATOM: TokenIdent
	| LITERAL
	| FUNC_DEF
	| ARRAY
	| GROUPED

LITERAL: TokenNum   { $$ = new_astnode(AstntNumLit);  $$->val.n = yyval.num; }
	   | TokenStr   { $$ = new_astnode(AstntStrLit);  $$->val.s = yyval.str; }
	   | TokenChar  { $$ = new_astnode(AstntCharLit); $$->val.c = yyval.ch;  }
	   | TokenTrue  { $$ = new_astnode(AstntBoolLit); $$->val.b = true;      }
	   | TokenFalse { $$ = new_astnode(AstntBoolLit); $$->val.b = false;     }

FUNC_DEF: TokenFn TokenLParen FUNC_ARGS TokenRParen TokenArrow BLOCK

FUNC_CALL: EXPR TokenLParen EXPR_LIST TokenRParen
		 | EXPR TokenLParen TokenRParen
		
EXPR_LIST: EXPR TokenComma EXPR_LIST
	  	 | EXPR

FUNC_ARGS: TokenIdent TokenComma FUNC_ARGS
		 | TokenIdent
		 |

IF_EXPR: TokenIf EXPR BLOCK ELIFS ELSE

ELIFS: TokenElif EXPR BLOCK ELIFS
	 |

ELSE: TokenElse BLOCK
	|

CASE_EXPR: TokenCase EXPR TokenLBrace CASE_ARMS TokenRBrace

CASE_ARMS: PATTERN TokenArrow CASE_VAL CASE_ARMS
		 |
		
PATTERN: TokenIdent
	   | LITERAL
	   | ARRAY

CASE_VAL: BLOCK
		| EXPR TokenComma

ARRAY: TokenLBrack EXPR_LIST TokenRBrack

GROUPED: TokenLParen EXPR TokenRParen
	
